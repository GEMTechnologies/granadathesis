```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND ARCHITECTURE                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LAYER 1: CORE (Reusable Infrastructure)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  app/core/                                                       â”‚
â”‚  â”œâ”€â”€ maker_framework.py  â† Generic voting & cost estimation     â”‚
â”‚  â”œâ”€â”€ red_flags.py        â† Quality detection (all task types)   â”‚
â”‚  â””â”€â”€ config.py           â† App configuration                     â”‚
â”‚                                                                  â”‚
â”‚  ğŸ¯ Purpose: General-purpose tools used by ALL agents           â”‚
â”‚  ğŸ”„ Reusable: Yes, by any agent                                 â”‚
â”‚  ğŸ“¦ Dependencies: None (only standard libs)                      â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“ uses
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LAYER 2: AGENTS (Task-Specific Logic)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  app/agents/                                                     â”‚
â”‚  â”œâ”€â”€ objective.py         â† Uses MAKER for objectives           â”‚
â”‚  â”œâ”€â”€ planner.py                                                  â”‚
â”‚  â”œâ”€â”€ objective_ranker.py                                         â”‚
â”‚  â”œâ”€â”€ variable_decomposer.py                                      â”‚
â”‚  â””â”€â”€ academic_rigor_validator.py                                 â”‚
â”‚                                                                  â”‚
â”‚  ğŸ¯ Purpose: Specific task handlers                             â”‚
â”‚  ğŸ”„ Reusable: No, task-specific                                 â”‚
â”‚  ğŸ“¦ Dependencies: core/, services/                               â”‚
â”‚                                                                  â”‚
â”‚  FUTURE AGENTS (will also use MAKER):                           â”‚
â”‚  â”œâ”€â”€ content.py           â† Will use MAKER for paragraphs       â”‚
â”‚  â”œâ”€â”€ literature_review.py â† Will use MAKER for sections         â”‚
â”‚  â””â”€â”€ methodology.py       â† Will use MAKER for methodology      â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“ uses
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  LAYER 3: SERVICES (External Integrations)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  app/services/                                                   â”‚
â”‚  â”œâ”€â”€ deepseek.py          â† DeepSeek API                        â”‚
â”‚  â”œâ”€â”€ openrouter.py        â† OpenRouter API (multi-model)        â”‚
â”‚  â”œâ”€â”€ gemini_direct.py     â† Gemini API                          â”‚
â”‚  â”œâ”€â”€ web_search.py        â† Web search                          â”‚
â”‚  â””â”€â”€ supabase.py          â† Database                            â”‚
â”‚                                                                  â”‚
â”‚  ğŸ¯ Purpose: External API wrappers                              â”‚
â”‚  ğŸ”„ Reusable: Yes, by any agent                                 â”‚
â”‚  ğŸ“¦ Dependencies: External APIs                                  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DATA FLOW: Objective Generation with MAKER                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

1. User Request
   â”‚
   â†“
2. generate_objectives_voting.py
   â”‚
   â†“
3. agents/objective.py
   â”‚  generate_objectives_with_voting()
   â”‚
   â”œâ”€â†’ core/maker_framework.py
   â”‚   â”‚  VotingOrchestrator
   â”‚   â”‚  â”œâ”€â†’ Generate sample 1 (temp=0.0)
   â”‚   â”‚  â”œâ”€â†’ Generate sample 2 (temp=0.1)
   â”‚   â”‚  â”œâ”€â†’ Generate sample 3 (temp=0.1)
   â”‚   â”‚  â””â”€â†’ Vote until consensus
   â”‚   â”‚
   â”‚   â””â”€â†’ core/red_flags.py
   â”‚       â”‚  RedFlagDetector
   â”‚       â”‚  â”œâ”€â†’ Check length
   â”‚       â”‚  â”œâ”€â†’ Check format
   â”‚       â”‚  â””â”€â†’ Check academic quality
   â”‚       â”‚
   â”‚       â””â”€â†’ Discard flagged samples
   â”‚
   â””â”€â†’ services/deepseek.py
       â”‚  Generate LLM responses
       â”‚
       â””â”€â†’ Return final objectives


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  WHY THIS STRUCTURE?                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

âœ… SEPARATION OF CONCERNS
   - Core = Infrastructure (how to vote)
   - Agents = Business logic (what to generate)
   - Services = External APIs (where to get data)

âœ… REUSABILITY
   - MAKER framework used by ALL agents
   - No code duplication
   - Single source of truth

âœ… SCALABILITY
   - Easy to add new agents
   - Easy to add new services
   - Easy to extend MAKER

âœ… MAINTAINABILITY
   - Changes to MAKER affect all agents automatically
   - Clear dependencies
   - Easy to test


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  FUTURE SCALING EXAMPLE                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

When you add paragraph generation:

1. Create app/agents/content.py
2. Import from app/core/maker_framework
3. Use same VotingOrchestrator
4. Use AcademicRedFlags.for_paragraphs()
5. Done!

NO changes needed to:
- core/maker_framework.py (already generic)
- core/red_flags.py (already has paragraph detector)
- Other agents (independent)

This is the power of good architecture! ğŸš€
```
